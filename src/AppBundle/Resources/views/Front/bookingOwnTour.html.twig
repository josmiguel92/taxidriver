{% extends 'AppBundle:Front:baseBooking.html.twig' %}


{% set title = "I will make my own tour "%}
{% if locale=='es' %}
    {% set title = "Hare mi propio camino " %}
{% endif %}

{% block destination %}
    <div class="well-row" data-prototype="&lt;div class=&quot;cell-md-6&quot;&gt;
                &lt;div class=&quot;form-group has-error&quot;&gt;
                    &lt;label for=&quot;ownroute_place_input___name__&quot; class=&quot;form-label rd-input-label&quot;&gt;Add a place&lt;/label&gt;
                    &lt;input id=&quot;ownroute_place_input___name__&quot; name=&quot;ownroute_place_input[__name__]&quot; data-constraints=&quot;@Required&quot; class=&quot;form-control form-control-has-validation form-control-last-child&quot; type=&quot;text&quot;&gt;&lt;span class=&quot;form-validation&quot;&gt;The text field is required.&lt;/span&gt;

                    &lt;span class=&quot;form-validation&quot;&gt;The text field is required.&lt;/span&gt;
                &lt;/div&gt;
            &lt;/div&gt;" id="ownroute_places_input_container">
        <div class="range range-xs-center text-sm-left">

                <div class="cell-md-6">
                    <div class="form-group has-error">
                        <label for="ownroute_place_input_0" class="form-label rd-input-label">Add a place</label>
                        <input id="ownroute_place_input_0" name="ownroute_place_input[0]" data-constraints="@Required" class="form-control form-control-has-validation form-control-last-child" type="text"><span class="form-validation">The text field is required.</span>

                        <span class="form-validation">The text field is required.</span>
                    </div>
                </div>
        </div>



    </div>
    <div>
        <a href="#" class="" id="deletePlaceInput"><i class=" fa fa-2x fa-minus-circle danger"></i> </a>
    </div>
    <div class="well-row" id="map-container" style="background-color: #2d672d; height: 18em;">

    </div>

{% endblock %}
{% block javascript %}
{{ parent() }}
<script>
        var $collectionHolder;
        // setup an "add a place" link
        var $addPlaceLink = $('<a href="#" class="add_place_link" id="addplacebtn"><i class=" fa fa-4x fa-plus-circle"></i> </a>');
        var $newLinkLi = $('<div></div>').append($addPlaceLink);
        jQuery(document).ready(function() {
// Get the ul that holds the collection of places
            $collectionHolder = $('#ownroute_places_input_container');
// add the "add a place" anchor and li to the places ul
            $collectionHolder.append($newLinkLi);
// count the current form inputs we have (e.g. 2), use that as the new
// index when inserting a new item (e.g. 2)
            $collectionHolder.data('index', $collectionHolder.find(':input').length);
            $addPlaceLink.on('click', function(e) {
// prevent the link from creating a "#" on the URL
                e.preventDefault();
// add a new place form (see next code block)
                if($('#ownroute_places_input_container').find(':input').last()[0].value.length > 0)
                    {
                        addplaceForm($collectionHolder, $newLinkLi);
                    }

            });

            $('#deletePlaceInput').click(function (e) {
                e.preventDefault();
                if($('#ownroute_places_input_container').children().length > 1)
                {
                    items = $('#ownroute_places_input_container').children()
                    items[items.length-2].remove();
                }
            });

            /*TODO: make this work*/
            $('#ownroute_places_input_container input').focusin(function (e) {
                //e.preventDefault();
                console.log('focus')
                $('label[for="'+this.getAttribute('id')+'"]').hide();
            });
        });

        function addplaceForm($collectionHolder, $newLinkLi) {
// Get the data-prototype explained earlier
            var prototype = $collectionHolder.data('prototype');
// get the new index
            var index = $collectionHolder.data('index');
// Replace '__name__' in the prototype's HTML to
// instead be a number based on how many items we have
            var newForm = prototype.replace(/__name__/g, index);
// increase the index with one for the next item
            $collectionHolder.data('index', index + 1);
            // Display the form in the page in a div, before the "Add a place" link div
            var $newFormLi = $('<div class=\"range range-xs-center text-sm-left\"></div>').append(newForm);
            $newLinkLi.before($newFormLi);
        }
    </script>
{% endblock %}